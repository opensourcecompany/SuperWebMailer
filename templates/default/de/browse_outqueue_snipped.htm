<div class="spacerborder">
  <form name="OutQueueForm" id="OutQueueForm" method="post" action="./browseoutqueue.php">

  <input type="hidden" name="OneOutQueueAction" id="OneOutQueueAction" value="" />
  <input type="hidden" name="OneOutQueueId" id="OneOutQueueId" value="" />

  <script language="javascript" type="text/javascript">
  <!--

    function SetListId(ASender, AFormID) {
      var AForm = document.getElementById(AFormID);
      var OneOutQueueAction = document.getElementById('OneOutQueueAction');
      var OneOutQueueId = document.getElementById('OneOutQueueId');
      OneOutQueueAction.value = ASender.name;
      OneOutQueueId.value = ASender.value;
      document.getElementById('OutQueueActions').selectedIndex = 0;
      return true;
    }

    function DoListActionChange(ASender, AFormID, AElementID, AElement2ID, ShowMessageBox) {
    }

    function CheckboxClicked() {
     DisableItem('OutQueueActions', GetCheckedCount('OutQueueIDs[]', 'OutQueueForm') > 0 );
     DoListActionChange( document.getElementById('OutQueueActions'), 'OutQueueForm', 'DestMailingList', 'Groups[]', false);
     ShowItem('ListActionSubmitBtn', (document.getElementById('OutQueueActions').selectedIndex != 0) && ( document.getElementById('OutQueueActions').disabled == false ) ) ;
    }

    function ConfirmDeleteOutQueueItemEvent(value) {
      if(value)
        $('#OutQueueForm').submit();
        else {
          document.getElementById('OneOutQueueAction').value = "";
          document.getElementById('OneOutQueueId').value = "";
        }

    }

    function ConfirmListActionEvent(value) {
      if(value)
        $('#OutQueueForm').submit();
    }

    function ConfirmListAction() {
      AOption = document.getElementById("OutQueueActions").options[ document.getElementById("OutQueueActions").selectedIndex ];

      if(AOption.value == "RemoveOutqueueEntries") {
        MessageBox('Best&auml;tigung', 'M&ouml;chten Sie wirklich <b>alle gew&auml;hlten</b> Versandeintr&auml;ge dauerhaft l&ouml;schen?', 3, 320, 120, 'ConfirmListActionEvent');
        return false;
      }
      return true;
    }

  //-->
  </script>

  <table class="FixedTable">
    <tbody>
      <tr>
        <td>
         <span style="float: right; margin-right: 0pt">
         </span>
         <p>
         <a href="javascript:void(0);" class="Backlink" onclick="ShowHideItem('ShowHideFilterBox')">Filter anzeigen / nicht anzeigen</a>
      			<div id="ShowHideFilterBox">
      			Sortiere Liste nach:&nbsp;
            <select size="1" name="Outqueuesortfieldname">
               <option value="SortLastSending">Letzter Sendeversuch</option>
               <option value="SortUsername">Nutzer</option>
               <option value="Sortid">ID</option>
               <option value="SortCreateDate">Erstellungsdatum</option>
               <option value="SortSendEngineRetryCount">Sendeversuche</option>
               <option value="SortSource">Quelle</option>
            </select>&nbsp;<select size="1" name="Outqueuesortorder"><option value="descending">absteigend</option><option value="ascending">aufsteigend</option></select>
      			<br />
         <br />
      			Zeige:&nbsp;<input type="text" name="OutQueueItemsPerPage" size="4" style="text-align:right" />&nbsp;Eintr&auml;ge&nbsp;pro&nbsp;Seite
      			<br />
         <br />
         <div style="float:right"><input type="submit" name="FilterApplyBtn" value="&Uuml;bernehmen" /></div>
         <input type="checkbox" name="OutQueueSaveFilter" value="true" />&nbsp;Filter zur n&auml;chsten Verwendung speichern
         </div>
         </p>
        </td>
      </tr>
      <tr>
      <td><img src="images/blind.gif" alt="" height="4" class="normalimage" /></td>
      </tr>
    </tbody>
  </table>
  <script language="JavaScript">
  <!--
    ShowHideItem('ShowHideFilterBox');
  //-->
  </script>
  <table id="TableRecipients" name="TableRecipients" class="FixedTable">
  	<thead>
  		<tr>
  			<td class="NoWrap" width="1%"><input name="SelectAllChkBox" type="checkbox" onclick="CheckAllCheckboxes('SelectAllChkBox', 'OutQueueIDs[]', 'OutQueueForm'); CheckboxClicked();" /></td>
  			<td class="NoWrap" width="5%" onclick="SortOnClick('Sortid', 'Outqueuesortfieldname', 'Outqueuesortorder');" onmouseover="CSSaddClass('tableRollOverEffect', this);this.style='cursor:pointer';" onmouseout="CSSremoveClass('tableRollOverEffect', this);this.style='cursor:auto';">ID</td>
  			<td class="NoWrap" width="1%">&nbsp;</td>
  			<td class="NoWrap" width="10%" onclick="SortOnClick('SortUsername', 'Outqueuesortfieldname', 'Outqueuesortorder');" onmouseover="CSSaddClass('tableRollOverEffect', this);this.style='cursor:pointer';" onmouseout="CSSremoveClass('tableRollOverEffect', this);this.style='cursor:auto';">Nutzer</td>
  			<td class="NoWrap" width="10%" onclick="SortOnClick('SortCreateDate', 'Outqueuesortfieldname', 'Outqueuesortorder');" onmouseover="CSSaddClass('tableRollOverEffect', this);this.style='cursor:pointer';" onmouseout="CSSremoveClass('tableRollOverEffect', this);this.style='cursor:auto';">Datum</td>
  			<td class="NoWrap" width="48%" onclick="SortOnClick('SortSource', 'Outqueuesortfieldname', 'Outqueuesortorder');" onmouseover="CSSaddClass('tableRollOverEffect', this);this.style='cursor:pointer';" onmouseout="CSSremoveClass('tableRollOverEffect', this);this.style='cursor:auto';">Quelle</td>
  			<td class="NoWrap" width="10%" onclick="SortOnClick('SortSendEngineRetryCount', 'Outqueuesortfieldname', 'Outqueuesortorder');" onmouseover="CSSaddClass('tableRollOverEffect', this);this.style='cursor:pointer';" onmouseout="CSSremoveClass('tableRollOverEffect', this);this.style='cursor:auto';">Sendeversuche</td>
  			<td class="NoWrap" width="1%">&nbsp;</td>
  			<td class="NoWrap" width="8%" onclick="SortOnClick('SortLastSending', 'Outqueuesortfieldname', 'Outqueuesortorder');" onmouseover="CSSaddClass('tableRollOverEffect', this);this.style='cursor:pointer';" onmouseout="CSSremoveClass('tableRollOverEffect', this);this.style='cursor:auto';">Letzter Sendeversuch</td>
  			<td class="NoWrap" width="1%">&nbsp;</td>
  			<td class="NoWrap" width="5%">Aktionen</td>
  		</tr>
  	</thead>
  	<tbody>
    <LIST:ENTRY>
  		<tr>
  			<td><input name="OutQueueIDs[]" type="checkbox" onclick="CheckboxClicked()" /></td>
  			<td class="NoWrapAlignRight"><LIST:ID></LIST:ID></td>
  			<td>&nbsp;</td>
  			<td class="NoWrapAlignCenter"><LIST:Username></LIST:Username></td>
  			<td class="NoWrapAlignCenter"><LIST:CreateDate></LIST:CreateDate></td>
  			<td><LIST:Source></LIST:Source></td>
  			<td class="NoWrapAlignRight"><LIST:SendEngineRetryCount></LIST:SendEngineRetryCount></td>
  			<td>&nbsp;</td>
  			<td class="NoWrapAlignRight"><LIST:LastSending></LIST:LastSending></td>
  			<td>&nbsp;</td>
  			<td>
      			<a href="#" onclick="var date = new Date();var nocache = date.getTime() / 1000; ShowModalDialog('./browseoutqueue.php?nocache=' + nocache + '&Result_id=', 720, 480); return false;"><img src="images/properties.gif" width="16" height="16" name="ViewOutQueueItemProperties" alt="" style="cursor:pointer;" class="normalimage" onmouseout="hideTooltip()" onmouseover="showTooltip(event,'Zeigt Eigenschaften des Eintrags.');return false" /></a>
         &nbsp;
  			    <input type="image" src="images/delete.gif" width="16" height="16" name="DeleteOutQueueItem" onclick="SetListId(this, 'OutQueueForm'); MessageBox('Best&auml;tigung', 'M&ouml;chten Sie wirklich diesen Eintrag dauerhaft l&ouml;schen?', 3, 320, 120, 'ConfirmDeleteOutQueueItemEvent'); return false;" alt="" style="cursor:pointer;" class="normalimage" onmouseout="hideTooltip()" onmouseover="showTooltip(event,'L&ouml;scht den Eintrag dauerhaft.');return false" />
		    </td>
  		</tr>
    </LIST:ENTRY>
  	</tbody>
  	</table>

 	 <table class="FixedTable">
 	 <thead></thead>
 	 <tbody></tbody>
  	<tfoot>

  		<tr>
  		  <td>
   		  <table border="0" cellpadding="0" cellspacing="0" width="100%">
   		  <tr>
   		  <td style="width:1%; white-space:nowrap; ">
     		  Selektierte:&nbsp;
   		  </td>
   		  <td style="width:60%; white-space:nowrap; ">
       		  <select name="OutQueueActions" id="OutQueueActions" size="1" onchange="DoListActionChange(this, 'OutQueueForm', 'DestMailingList', 'Groups[]', true); ShowItem('ListActionSubmitBtn', (document.getElementById('OutQueueActions').selectedIndex != 0) && ( document.getElementById('OutQueueActions').disabled == false ) ); ">
         		  <option value="doNothing">Aktion w&auml;hlen</option>
         		  <option value="RemoveOutqueueEntries">L&ouml;scht die gew&auml;hlten Eintr&auml;ge</option>
       		  </select>
       		  <input type="submit" name="ListActionSubmitBtn" id="ListActionSubmitBtn" value="Ausf&uuml;hren" onclick="return ConfirmListAction()" />
   		  </td>
        <td style="text-align:right; width:1%; white-space:nowrap; ">
       			  <input type="image" width="16" height="16" name="TopBtn" id="TopBtn" value="Top" onclick="SetListId(this, 'OutQueueForm');" src="images/arrow_left_end.gif" style="vertical-align:bottom; cursor: pointer;" alt="" onmouseout="hideTooltip()" onmouseover="showTooltip(event,'Anfang der Liste');return false" />&nbsp;
       			  <input type="image" width="16" height="16" name="PrevBtn" id="PrevBtn" value="Prev" onclick="SetListId(this, 'OutQueueForm');" src="images/arrow_left.gif" style="vertical-align:bottom; cursor: pointer;" alt="" onmouseout="hideTooltip()" onmouseover="showTooltip(event,'Vorherige Seite');return false" />&nbsp;
       			  <input type="image" width="16" height="16" name="NextBtn" id="NextBtn" value="Next" onclick="SetListId(this, 'OutQueueForm');" src="images/arrow_right.gif" style="vertical-align:bottom; cursor: pointer;" alt="" onmouseout="hideTooltip()" onmouseover="showTooltip(event,'N&auml;chste Seite');return false" />&nbsp;
       			  <input type="image" width="16" height="16" name="EndBtn" id="EndBtn" value="End" onclick="SetListId(this, 'OutQueueForm');" src="images/arrow_right_end.gif" style="vertical-align:bottom; cursor: pointer;" alt="" onmouseout="hideTooltip()" onmouseover="showTooltip(event,'Ende der Liste');return false" />&nbsp;
        </td>
        <td style="text-align:right; width:1%; white-space:nowrap; ">
         			  Seite:&nbsp;
        </td>
        <td style="text-align:right; width:1%; white-space:nowrap; ">
         			  <select name="OutQueuePageSelected" id="OutQueuePageSelected" size="1" style="min-width:30pt ! important;" onchange="$('#OutQueueForm').submit();">
                <OPTION:PAGES>
                <option>1</option>
                </OPTION:PAGES>
         			  </select>
        </td>
       	</tr>
       	</table>
  			</td>
  		</tr>

  	</tfoot>
  </table>
  </form>
</div>
<script type="text/javascript">
<!--
  addTableRolloverEffect('TableRecipients','tableRollOverEffect','tableRowClickEffect');
  DoListActionChange(document.getElementById("OutQueueActions"), 'OutQueueForm', 'DestMailingList', 'Groups[]', false);
  CheckboxClicked();
  ShowItem('ListActionSubmitBtn', (document.getElementById('OutQueueActions').selectedIndex != 0) && ( document.getElementById('OutQueueActions').disabled == false ) ) ;
  DisableItem('OutQueueActions', GetCheckedCount('OutQueueIDs[]', 'OutQueueForm') > 0 );
  InsertLoadingStatusOnSubmit();
  //AUTO_SCRIPT_CODE_PLACEHOLDER//
//-->
</script>
