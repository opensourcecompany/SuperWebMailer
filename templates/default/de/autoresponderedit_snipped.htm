      <script type="text/javascript" src="js/jquery-latest.min.js"></script>
      <link rel="stylesheet" type="text/css" href="css/scrollbox.css" />
      <script language="javascript" type="text/javascript" src="js/scrollbox.js"></script>
      <script language="javascript" type="text/javascript">
      <!--

        function load_forms(){
         var date = new Date();
         var nocache = date.getTime() / 1000;
         $("#Loading").show();
         $("#formsList").hide();
         $.ajaxSetup({ cache: false });

        	jQuery.get('ajax_getforms.php' + "?nocache=" + nocache + '&MailingListId=' + $("#maillists_id").val(), "", function(data){
        	   $("#formsList").html( data );
        	});

         $("#Loading").hide();
         $("#formsList").show();
        }

      //-->
      </script>
      <script language="JavaScript" type="text/javascript">
      <!--
        var TabListArray = Array();
        var InnerTabListArray = Array();

        function DoShowSerialMailPreviewDialog() {

          var select = document.getElementById("maillists_id");
          if( select.selectedIndex < 0 || select.disabled ) return false;
          var index = select.selectedIndex;

          var MailingListId = select.options[index].value;


          var FormId = document.getElementById("formsList").value;
          var AutoresponderId = document.getElementById("AutoresponderId").value;

          if(AutoresponderId == 0 || AutoresponderId == "") {
            return false;
          }
          if(FormId == 0 || FormId == "") {
            return false;
          }
          if(MailingListId == 0 || MailingListId == "") {
            return false;
          }


          SerialMailPreviewOpenResponder(MailingListId, FormId, "AutoResponder", AutoresponderId, "");
        }

        function DoShowFunctionsDialog(formId, formElementId, isfckeditor) {
          FunctionsOpen(formId, formElementId, isfckeditor);
        }

        var myBasePath='';

        // default placeholders
        var arrPlaceholderItems = new Array(
            new Array('[PLACEHOLDER]', 'PLACEHOLDERTEXT')
      	    );

      	 // special placeholders for newsletter subscribe / unsubscribe
      	 var arrNewsletterUnsubscribePlaceholders = new Array(
            new Array('[NEWSLETTER_UNSUBSCRIBEPLACEHOLDER]', 'NEWSLETTER_UNSUBSCRIBEPLACEHOLDERTEXT')
      	 );

      	 // special placeholders for responders
      	 var arrResponderPlaceholders = new Array(
            new Array('[RESPONDER_PLACEHOLDER]', 'RESPONDER_PLACEHOLDERTEXT')
      	 );

        function ConfirmEditMTAsEvent(value) {
         if(value)
           CreateFormAndPostIt("./browsemtas.php");
        }

        function ConfirmEditInboxesEvent(value) {
         if(value)
           CreateFormAndPostIt("./browseinboxes.php");
        }
        
        function ConfirmEditMailinglistsEvent(value) {
         if(value)
           CreateFormAndPostIt("./browsemailinglists.php");
        }


        /* from page http://blog.pothoven.net/2006/10/move-options-up-and-down-select-lists.html */
        function moveOptionsUp(selectId) {
           var selectList = document.getElementById(selectId);
           var selectOptions = selectList.getElementsByTagName('option');
           for (var i = 1; i < selectOptions.length; i++) {
              var opt = selectOptions[i];
              if (opt.selected) {
                 selectList.removeChild(opt);
                 selectList.insertBefore(opt, selectOptions[i - 1]);
                 break; // only one
               }
           }
        }

        function moveOptionsDown(selectId) {
          var selectList = document.getElementById(selectId);
          var selectOptions = selectList.getElementsByTagName('option');
          for (var i = selectOptions.length - 2; i >= 0; i--) {
             var opt = selectOptions[i];
             if (opt.selected) {
               var nextOpt = selectOptions[i + 1];
               opt = selectList.removeChild(opt);
               nextOpt = selectList.replaceChild(opt, nextOpt);
               selectList.insertBefore(nextOpt, opt);
               break; // only one
             }
          }
        }
        //

        function MoveMTA(direction) {
          select = document.getElementById("mtas[]");
          index = select.selectedIndex;
          if(direction == "Up" && index < 0) return;
          if(direction == "Down" && index > select.options.length) return;
          if(direction == "Up")
             moveOptionsUp("mtas[]");
          if(direction == "Down")
             moveOptionsDown("mtas[]");
        }


       var previousActiveElementId=null;

      //-->
      </script>

      <div class="spacerborder">
        <form method="post" id="AutoresponderEditForm" name="AutoresponderEditForm" action="./autoresponderedit.php" onsubmit="CheckAndRemoveCriticalChars('AutoresponderEditForm');">
          <input type="hidden" id="AutoresponderId" name="AutoresponderId" />
          <input type="hidden" id="FormId" name="FormId" />
          <input type="hidden" name="TargetGroupsSupport" id="TargetGroupsSupport" value="1" />

          <span class="Backlink"><a href="./browseautoresponders.php">Zur&uuml;ck</a></span><br />
          <br />
          <table class="FormTable" cellspacing="0" cellpadding="0" border="0">
            <tbody>
              <tr>
                <td>

                  <!-- ##### TabView - START -->
                  <div id="dhtmlgoodies_tabView">

                    <!-- ####### TAB START -->
                    <script language="JavaScript" type="text/javascript">
                    <!--
                      TabListArray.push('Allgemein');
                    //-->
                    </script>
                  	<div class="dhtmlgoodies_aTab">
                      <fieldset>
                      <legend><SHOWHIDE:TOOLTIPS>
                                  <img onmouseover="showTooltip(event, 'Geben Sie dem Autoresponder einen eindeutigen Namen.');return false" onmouseout="hideTooltip()" src="images/help_icon.gif" width="16" height="16" class="hintimage" alt="" />
                                  </SHOWHIDE:TOOLTIPS>Allgemein</legend>
                      <br />
                          <table class="FormTable" cellspacing="0" cellpadding="0" border="0">
                            <tbody>
                              <tr>
                                <td class="MessageDescriptionColumn">Name des Autoresponders
                                </td>
                                <td><input type="text" id="Name" name="Name" maxlength="128" size="50" /></td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn">Autoresponder aktivieren/deaktivieren
                                </td>
                                <td><input type="checkbox" id="IsActive" name="IsActive" /><label for="IsActive">&nbsp;Autoresponder ist aktiv</label></td>
                              </tr>
                            </tbody>
                          </table>
                      </fieldset>

                      <fieldset>
                      <legend>Zeitplanung</legend>
                      <br />
                          <table class="FormTable" cellspacing="0" cellpadding="0" border="0">
                            <tbody>
                              <tr>
                                <td class="MessageDescriptionColumn">Autoresponder immer ausf&uuml;hren
                                </td>
                                <td valign="top"><input type="checkbox" name="NoTiming" id="NoTiming" onclick="DisableControlsArray(!document.getElementById('NoTiming').checked, Array(document.getElementById('TimingFrom'), document.getElementById('TimingTo'), document.getElementById('TimingMultipleDayNamesScrollbox')), Array(document.getElementById('TimingLabel'), document.getElementById('TimingLabel1'), document.getElementById('TimingLabel2') ) );" /></td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">&nbsp;
                                </td>
                                <td>

                                  <table class="InnerTable" cellspacing="0" cellpadding="0" border="0">
                                     <tbody>
                                      <tr>
                                        <td id="TimingLabel" style="width: 20%">
                                          nur ausf&uuml;hren zwischen
                                        </td>
                                        <td>
                                          <span id="TimingLabel1" style="width: 80%">
                                            <input type="text" name="TimingFrom" id="TimingFrom" maxlength="8" size="8" />&nbsp;Uhr
                                            und&nbsp;
                                            <input type="text" name="TimingTo" id="TimingTo" maxlength="8" size="8" />&nbsp;Uhr
                                          </span>
                                        </td>
                                      </tr>
                                      <tr>
                                        <td style="width: 20%">
                                          &nbsp;
                                        </td>
                                        <td>
                                          <span id="TimingLabel2" style="width: 80%">
                                             <div class="scrollbox" style="width: 310px; height: 100px" name="TimingMultipleDayNamesScrollbox" id="TimingMultipleDayNamesScrollbox">
                                               <SHOW:TimingMultipleDayNames>
                                                 <span class="scrollboxSpan"><input type="checkbox" name="TimingMultipleDayNames[]" value="<TimingMultipleDayNamesValue></TimingMultipleDayNamesValue>" id="TimingMultipleDayNamesId" />&nbsp;<label for="TimingMultipleDayNamesId"><TimingMultipleDayName></TimingMultipleDayName></label><br /></span>
                                               </SHOW:TimingMultipleDayNames>
                                             </div>
                                          </span>
                                        </td>
                                      </tr>
                                    </tbody>
                                  </table>


                                </td>
                              </tr>
                            </tbody>
                          </table>
                      </fieldset>

                      <fieldset>
                      <legend>Informationen</legend>
                      <br />
                          <table class="FormTable" cellspacing="0" cellpadding="0" border="0">
                            <tbody>
                              <tr>
                                <td class="MessageDescriptionColumn">Erstellungsdatum des Autoresponders
                                </td>
                                <td><SHOW:CREATEDATE></SHOW:CREATEDATE><input type="hidden" name="CREATEDATE" /></td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">Bisher beantwortete E-Mails
                                </td>
                                <td><SHOW:EMAILSPROCESSED></SHOW:EMAILSPROCESSED></td>
                              </tr>

                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">Anzahl unzustellbare E-Mails (Hard bounces)
                                </td>
                                <td><HARDBOUNCESCOUNT></HARDBOUNCESCOUNT></td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">Undefinierte R&uuml;ckl&auml;ufer (Soft bounces)
                                </td>
                                <td><SOFTBOUNCESCOUNT></SOFTBOUNCESCOUNT></td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">Anzahl Abmeldungen
                                </td>
                                <td><UNSUBSCRIBESCOUNT></UNSUBSCRIBESCOUNT></td>
                              </tr>
                            </tbody>
                          </table>
                      </fieldset>
                  	</div>
                  	<!-- ####### TAB END -->


                  	<!-- ####### TAB START -->
                    <script language="JavaScript" type="text/javascript">
                    <!--
                      TabListArray.push('E-Mail-Verarbeitung');
                    //-->
                    </script>
                  	<div class="dhtmlgoodies_aTab">
                      <fieldset>
                      <legend><SHOWHIDE:TOOLTIPS>
                                  <img onmouseover="showTooltip(event, 'Jedem Autoresponder muss ein Posteingangsserver f&uuml;r den Abruf von neuen E-Mails zugewiesen werden.<br /><br />Mit Semikolon(;) getrennt k&ouml;nnen Teilzeichenketten als Bedingung f&uuml;r die Beantwortung angegeben werden.<br /><br />Geben Sie ebenfalls die maximale Anzahl E-Mails an, die abgerufen und beantwortet werden sollen. Ist die Anzahl zu hoch eingestellt, dann k&ouml;nnte es zum Abbruch des Scripts f&uuml;hren.');return false" onmouseout="hideTooltip()" src="images/help_icon.gif" width="16" height="16" class="hintimage" alt="" />
                                  </SHOWHIDE:TOOLTIPS>Posteingangsserver/Postfach des Autoresponders</legend>
                      <br />
                          <table class="FormTable" cellspacing="0" cellpadding="0" border="0">
                            <tbody>
                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">Posteingangsserver/Postfach
                                <br /><a href="./browseinboxes.php" onclick="MessageBox('Best&auml;tigung', 'Alle ver&auml;nderten Einstellungen auf diesen Seite(n) gehen verloren.<br /><br />M&ouml;chten Sie jetzt wirklich neue Posteingangsserver definieren?', 3, 320, 160, 'ConfirmEditInboxesEvent'); return false;">(Neue Postf&auml;cher definieren)</a>
                                </td>
                                <td>
                                <select name="inboxes_id" id="inboxes_id" size="1">
                                   <SHOW:INBOXES>
                                   </SHOW:INBOXES>
                                </select>
                                <br /><br />
                                </td>
                              </tr>

                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">
                                  Nur f&uuml;r IMAP-Postf&auml;cher
                                </td>
                                <td>
                                  <input type="checkbox" name="UnseenMsgsOnly" id="UnseenMsgsOnly" /><label for="UnseenMsgsOnly">&nbsp;Nur ungelesene E-Mails beantworten.</label>
                                <br /><br />
                                </td>
                              </tr>

                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">Antwort senden an
                                </td>
                                <td>
                                  <select name="AnswerHeaderField" size="1">
                                    <option value="ReturnPath">Return-Path-E-Mail-Adresse</option>
                                    <option value="From">Absender(From)-E-Mail-Adresse</option>
                                    <option value="ReplyTo">Antwortadresse(Reply-To)</option>
                                  </select>
                                <br /><br />
                                </td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">Nur E-Mails mit diesen Text(en) im Betreff beantworten
                                </td>
                                <td>
                                <input type="text" name="EMailAnswerSubjects" size="80" />
                                <br /><br />
                                </td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">Maximale Anzahl E-Mails, die abgerufen werden sollen
                                </td>
                                <td>
                                <input type="text" name="MaxEMailsToProcess" size="3" style="text-align: right" />
                                <br /><br />
                                </td>
                              </tr>
                            </tbody>
                          </table>
                      </fieldset>

                      <fieldset>
                      <legend><SHOWHIDE:TOOLTIPS>
                                  <img onmouseover="showTooltip(event, 'Der Mail-Looping-Schutz dient dazu Mailschleifen zu vermeiden, d.h. E-Mails von anderen Autorespondern werden nicht beantwortet, da es ansonsten zu unendlich vielen versendeten E-Mails kommen kann.');return false" onmouseout="hideTooltip()" src="images/help_icon.gif" width="16" height="16" class="hintimage" alt="" />
                                  </SHOWHIDE:TOOLTIPS>Mail-Looping-Schutz</legend>
                      <br />
                          <table class="FormTable" cellspacing="0" cellpadding="0" border="0">
                            <tbody>
                              <tr>
                                <td colspan="2" class="MessageDescriptionColumn" valign="top">
                                <input type="checkbox" name="IgnoreHeaderXLoop" id="IgnoreHeaderXLoop" /><label for="IgnoreHeaderXLoop">&nbsp;E-Mails mit X-Loop Header-Feld ignorieren (empfohlen)</label>
                                <br />
                                </td>
                              </tr>
                              <tr>
                                <td colspan="2" class="MessageDescriptionColumn" valign="top">
                                 <input type="checkbox" name="AddXLoop" id="AddXLoop" /><label for="AddXLoop">&nbsp;X-Loop Header-Feld beim Versand einer Antwort-E-Mail hinzuf&uuml;gen (empfohlen)</label>
                                 <br />
                                </td>
                              </tr>

                              <tr>
                                <td colspan="2" class="MessageDescriptionColumn" valign="top">
                                 <input type="checkbox" name="AutoresponderLimit" id="AutoresponderLimit" onclick="DisableItem('AutoresponderLimitPerDay', document.getElementById('AutoresponderLimit').checked);" /><label for="AutoresponderLimit">&nbsp;Anzahl Autoresponder-E-Mails an eine E-Mail-Adresse pro Tag limitieren</label>
                                 <br />
                                </td>
                              </tr>

                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">
                                  &nbsp;
                                </td>
                                <td valign="top">
                                 <label for="AutoresponderLimitPerDay">Maximal Anzahl E-Mails pro Tag:</label>&nbsp;<input type="text" name="AutoresponderLimitPerDay" id="AutoresponderLimitPerDay" size="6" maxlength="5" style="text-align: right" />
                                </td>
                              </tr>

                            </tbody>
                          </table>
                      </fieldset>

                      <fieldset>
                      <legend><SHOWHIDE:TOOLTIPS>
                                  <img onmouseover="showTooltip(event, 'Jedem Autoresponder kann optional eine Empf&auml;ngerliste zugewiesen werden. Die Absender-E-Mail-Adressen der beantworteten E-Mails k&ouml;nnen so dauerhaft in einer Empf&auml;ngerliste gespeichert werden.');return false" onmouseout="hideTooltip()" src="images/help_icon.gif" width="16" height="16" class="hintimage" alt="" />
                                  </SHOWHIDE:TOOLTIPS>Empf&auml;ngerliste f&uuml;r den Autoresponder</legend>
                      <br />
                          <table class="FormTable" cellspacing="0" cellpadding="0" border="0">
                            <tbody>
                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">
                                <input type="checkbox" name="UpdateMailingList" id="UpdateMailingList" value="on"
                                onclick="DisableControlsArray(document.getElementById('UpdateMailingList').checked, Array(document.getElementById('maillists_id'), document.getElementById('NoAnswerOnMemberExists'), document.getElementById('formsList'), document.getElementById('SerialMailPreviewDialog')), Array(document.getElementById('NoAnswerOnMemberExistsLabel'))); if(document.getElementById('UpdateMailingList').checked) load_forms();" /><label for="UpdateMailingList">&nbsp;Empf&auml;ngerliste aktualisieren</label>
                                <br /><a href="./browsemailinglists.php" onclick="MessageBox('Best&auml;tigung', 'Alle ver&auml;nderten Einstellungen auf diesen Seite(n) gehen verloren.<br /><br />M&ouml;chten Sie jetzt wirklich neue Empf&auml;ngerlisten definieren?', 3, 320, 160, 'ConfirmEditMailinglistsEvent'); return false;">(Neue Empf&auml;ngerliste definieren)</a>
                                </td>
                                <td valign="top">
                                  <select name="maillists_id" id="maillists_id" size="1" onchange="load_forms();">
                                     <SHOW:MAILINGLISTS>
                                     </SHOW:MAILINGLISTS>
                                  </select>
                                </td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">
                                &nbsp;
                                </td>
                                <td>
                                  <input type="checkbox" name="NoAnswerOnMemberExists" id="NoAnswerOnMemberExists" value="1" /><label for="NoAnswerOnMemberExists">&nbsp;<span id="NoAnswerOnMemberExistsLabel" name="NoAnswerOnMemberExistsLabel">Keine automatische Antwort, falls sich die E-Mail-Adresse bereits in der Empf&auml;ngerliste befindet.</span></label>
                                </td>
                              </tr>

                              <tr>
                                <td class="MessageDescriptionColumn">Formular f&uuml;r die Abmeldung/&Auml;nderung<SHOWHIDE:TOOLTIPS>
                                  <img onmouseover="showTooltip(event, 'W&auml;hlen Sie das An-/Abmeldeformular, das f&uuml;r das Abmelde- und &Auml;nderungsformular verwendet werden soll. Diese Einstellung ist bei Verwendung von mehreren Sprachen f&uuml;r die Empf&auml;nger einer Empf&auml;ngerliste wichtig.');return false" onmouseout="hideTooltip()" src="images/help_icon.gif" class="hintimage" width="16" height="16" alt=""/>
                                  </SHOWHIDE:TOOLTIPS>
                                </td>
                                <td><select name="forms_id" size="1" id="formsList">
                                    <SHOW:Forms>
                                    </SHOW:Forms>
                                    </select>
                                		  <span id="Loading" style="visibility:hidden; display: none"><img src="images/loading.gif" height="16" width="16" /></span>
                                    <br /><br />
                                </td>
                              </tr>

                            </tbody>
                          </table>
                      </fieldset>

                  	</div>
                  	<!-- ####### TAB END -->

                  	<!-- ####### TAB START -->
                    <script language="JavaScript" type="text/javascript">
                    <!--
                      TabListArray.push('E-Mail-Versand');
                    //-->
                    </script>
                  	<div class="dhtmlgoodies_aTab">
                      <fieldset>
                      <legend><SHOWHIDE:TOOLTIPS>
                                  <img onmouseover="showTooltip(event, 'Geben Sie mindestens Absender-E-Mail-Adresse und angezeigter Absender-Name an. Die anderen Optionen sind optional.');return false" onmouseout="hideTooltip()" src="images/help_icon.gif" width="16" height="16" class="hintimage" alt="" />
                                  </SHOWHIDE:TOOLTIPS>E-Mail-Adressen f&uuml;r den E-Mail-Versand</legend>
                      <br />
                          <table class="FormTable" cellspacing="0" cellpadding="0" border="0">
                            <tbody>
                              <tr>
                                <td class="MessageDescriptionColumn">Absender E-Mail-Adresse
                                </td>
                                <td><input type="text" id="SenderFromAddress" name="SenderFromAddress" maxlength="128" size="50" /></td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn">Angezeigter Absender-Name
                                </td>
                                <td><input type="text" id="SenderFromName" name="SenderFromName" maxlength="128" size="50" /></td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn">Antwort-E-Mail-Adresse (Reply-to)
                                </td>
                                <td><input type="text" id="ReplyToEMailAddress" name="ReplyToEMailAddress" maxlength="128" size="50" /></td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn">E-Mail-Adresse f&uuml;r die Return-Path-Angabe
                                </td>
                                <td><input type="text" id="ReturnPathEMailAddress" name="ReturnPathEMailAddress" maxlength="128" size="50" /></td>
                              </tr>
                              <tr><td>&nbsp;</td></tr>
                            </tbody>
                          </table>
                      </fieldset>

                      <fieldset>
                      <legend>Optionale Parameter f&uuml;r den E-Mail-Versand</legend>
                      <br />
                          <table class="FormTable" cellspacing="0" cellpadding="0" border="0">
                            <tbody>
                              <tr>
                                <td class="MessageDescriptionColumn">Lesebest&auml;tigung anfordern<SHOWHIDE:TOOLTIPS>
                                  <img onmouseover="showTooltip(event, 'Fordert eine Lesebest&auml;tigung an. Nicht jeder Server oder E-Mail-Programm unterst&uuml;tzt diese Funktion. Beim Versand sehr vieler E-Mails kann diese Funktion Ihren eigenen Mailserver stark belasten, da viele E-Mails mit der Lesebest&auml;tigung zur&uuml;ckgesendet werden.');return false" onmouseout="hideTooltip()" src="images/help_icon.gif" width="16" height="16" class="hintimage" alt="" />
                                  </SHOWHIDE:TOOLTIPS>
                                </td>
                                <td><input type="checkbox" id="ReturnReceipt" name="ReturnReceipt" /></td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn">Sichtbare Kopien-Empf&auml;nger (Cc)<SHOWHIDE:TOOLTIPS>
                                  <img onmouseover="showTooltip(event, 'Geben Sie eine oder mehrere E-Mail-Adressen mit Komma (,) getrennt an, die eine sichtbare Kopie(Cc) erhalten sollen.');return false" onmouseout="hideTooltip()" src="images/help_icon.gif" width="16" height="16" class="hintimage" alt="" />
                                  </SHOWHIDE:TOOLTIPS>
                                </td>
                                <td><input type="text" id="CcEMailAddresses" name="CcEMailAddresses" size="50" /></td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn">Unsichtbare Blindkopien-<br />Empf&auml;nger (BCc)<SHOWHIDE:TOOLTIPS>
                                  <img onmouseover="showTooltip(event, 'Geben Sie eine oder mehrere E-Mail-Adressen mit Komma (,) getrennt an, die eine unsichtbare Blindkopie(BCc) erhalten sollen.');return false" onmouseout="hideTooltip()" src="images/help_icon.gif" width="16" height="16" class="hintimage" alt="" />
                                  </SHOWHIDE:TOOLTIPS>
                                </td>
                                <td><input type="text" id="BCcEMailAddresses" name="BCcEMailAddresses" size="50" /></td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">
                                  List-Unsubscribe-Header-Feld in die E-Mails f&uuml;r die Abmeldung einf&uuml;gen<SHOWHIDE:TOOLTIPS>
                                  <img onmouseover="showTooltip(event, 'Das List-Unsubscribe Feld mit dem Abmeldelink kann in den unsichtbaren Header der E-Mail aufgenommen werden, so dass bei diversen webbasierten Anbietern z.B. Microsoft Hotmail eine direkte Abmeldung vom Newsletter oberhalb der angezeigten E-Mail mit einem Klick m&ouml;glich ist.');return false" onmouseout="hideTooltip()" src="images/help_icon.gif" width="16" height="16" class="hintimage" alt="" />
                                  </SHOWHIDE:TOOLTIPS>
                                </td>
                                <td valign="top">
                                  <input type="checkbox" name="AddListUnsubscribe" id="AddListUnsubscribe" /><label for="AddListUnsubscribe">&nbsp;List-Unsubscribe-Header-Feld hinzuf&uuml;gen (nur wenn Empf&auml;ngerliste aktualisiert wird)</label>
                                </td>
                              </tr>
                              <tr><td colspan="2">&nbsp;</td></tr>
                            </tbody>
                          </table>
                      </fieldset>

                      <fieldset>
                      <legend><SHOWHIDE:TOOLTIPS>
                                  <img onmouseover="showTooltip(event, 'Jeder Autoresponder muss eine Versandvariante zugewiesen bekommen.');return false" onmouseout="hideTooltip()" src="images/help_icon.gif" width="16" height="16" class="hintimage" alt="" />
                                  </SHOWHIDE:TOOLTIPS>Versandvariante (MTA) des Autoresponders</legend>
                      <br />
                          <table class="FormTable" cellspacing="0" cellpadding="0" border="0">
                            <tbody>
                              <tr>
                                <td class="MessageDescriptionColumn" valign="top">Versandvariante
                                <br /><a href="./browsemtas.php" onclick="MessageBox('Best&auml;tigung', 'Alle ver&auml;nderten Einstellungen auf diesen Seite(n) gehen verloren.<br /><br />M&ouml;chten Sie jetzt wirklich neue Versandvarianten definieren?', 3, 320, 160, 'ConfirmEditMTAsEvent'); return false;">(Neue Versandvariante definieren)</a>
                                </td>
                                <td>
                                <select name="mtas_id" id="mtas_id" size="1">
                                   <SHOW:MTAS>
                                   </SHOW:MTAS>
                                </select>
                                <br />
                                </td>
                              </tr>
                            </tbody>
                          </table>
                      </fieldset>
                  	</div>
                  	<!-- ####### TAB END -->

                  	<!-- ####### TAB START -->
                    <script language="JavaScript" type="text/javascript">
                    <!--
                      TabListArray.push('Antwort-E-Mail');
                    //-->
                    </script>
                  	<div class="dhtmlgoodies_aTab">
                      <fieldset>
                      <legend>Inhaltsangaben
                      <input type="image" name="SerialMailPreviewDialog" id="SerialMailPreviewDialog" onclick="DoShowSerialMailPreviewDialog(); return false;" onmouseover="showTooltip(event, 'Zeigt die E-Mail in der Serien-E-Mail-Vorschau an.<br /><br /><b>Wichtig</b> &Auml;nderungen am Text werden nur nach dem Speichern der Einstellungen dieses Formulars angezeigt.');return false" onmouseout="hideTooltip()" src="images/serialmailpreview.gif" class="hintimage" alt="" />
                      </legend>
                        <br />
                          <table class="FormTable" cellspacing="0" cellpadding="0" border="0">
                            <tbody>

                              <tr>
                               <td class="MessageDescriptionColumn" id="MailFormatLabel" name="MailFormatLabel">
                                 Format der E-Mail
                               </td>
                               <td>
                                 <select id="MailFormat" name="MailFormat" size="1" onchange="ShowHideEMailTexts();PageModified=true;">
                                  <option value="PlainText">Reine Text-E-Mail</option>
                                  <option value="HTML">Reine HTML-E-Mail (nicht empfohlen)</option>
                                  <option value="Multipart">HTML- und Text-E-Mail (multipart E-Mail, empfohlen)</option>
                                 </select>
                               </td>
                              </tr>

                              <tr>
                                <td class="MessageDescriptionColumn">Codierung</td>
                                <td valign="top">
                                <select name="MailEncoding" size="1" onchange="PageModified=true;">
                                <option value="iso-8859-1">Normal/Europa (iso-8859-1)</option>
                                <option value="utf-8">UTF-8</option>
                                <MAILENCODINGS></MAILENCODINGS>
                                </select>
                                </td>
                              </tr>
                              <tr>
                                <td class="MessageDescriptionColumn">Priorit&auml;t</td>
                                <td valign="top">
                                <select name="MailPriority" size="1" onchange="PageModified=true;">
                                  <option value="Low">Niedrig</option>
                                  <option value="Normal">Normal</option>
                                  <option value="High">Hoch</option>
                                </select>
                                </td>
                              </tr>
                             <tr>
                               <td class="MessageDescriptionColumn">Cache f&uuml;r E-Mail-Versand verwenden<SHOWHIDE:TOOLTIPS>
                                  <img onmouseover="showTooltip(event, 'Der Cache beschleunigt den E-Mail-Versand und spart CPU-Zeit bei der Versendung von Serien-E-Mails, wenn eingebettete Bilder und Anh&auml;nge mit der E-Mail versendet werden.<br /><br />Sollten Sie E-Mails mit personalisierten Bildern versenden wollen, dann muss die Cache-Option deaktiviert werden.');return false" onmouseout="hideTooltip()" src="images/help_icon.gif" width="16" height="16" class="hintimage" alt="" />
                                  </SHOWHIDE:TOOLTIPS></td>
                               <td valign="top">
                                  <input type="checkbox" name="Caching" value="1" />
                               </td>
                             </tr>
                            </tbody>
                          </table>
                      </fieldset>

                      <fieldset>
                      <legend>Betreff der E-Mail und Pre-Header</legend>
                        <br />
                          <table class="FormTable" cellspacing="0" cellpadding="0" border="0">
                            <tbody>
                              <tr>
                                <td colspan="2" valign="middle">

                                <select size="1" title="Feld in E-Mail-Betreff oder Pre-Header einf&uuml;gen" id="SubjectPlaceHoldersCB" onchange="InsertFieldValue('SubjectPlaceHoldersCB', previousActiveElementId ? previousActiveElementId : 'MailSubject' )" onmousedown="if(document.activeElement && document.activeElement != this){if(document.activeElement.id == 'MailSubject' || document.activeElement.id == 'MailPreHeaderText') previousActiveElementId=document.activeElement.id; else previousActiveElementId=null;}">
                                  <option selected="selected">Feld zum Einf&uuml;gen w&auml;hlen...</option>
                                </select>

                                &nbsp;
                                <input type="image" src="images/blind.gif" width="24" height="24" class="FctButton ExternalButton" onclick="DoShowFunctionsDialog(this.form.id, previousActiveElementId ? previousActiveElementId : 'MailSubject', false); return false;" alt="Funktionen" title="Funktionen in E-Mail-Betreff oder Pre-Header einf&uuml;gen" style="vertical-align:bottom"  onmousedown="if(document.activeElement && document.activeElement != this){if(document.activeElement.id == 'MailSubject' || document.activeElement.id == 'MailPreHeaderText') previousActiveElementId=document.activeElement.id; else previousActiveElementId=null;}" />
                                &nbsp;
                                <input type="image" src="images/blind.gif" width="24" height="24" class="EmojiButton ExternalButton" onclick="EmojisOpen(this.form.id, previousActiveElementId ? previousActiveElementId : 'MailSubject', false); return false;" alt="Emoji einf&uuml;gen" title="Emoji in E-Mail-Betreff oder Pre-Header einf&uuml;gen" style="vertical-align:bottom"  onmousedown="if(document.activeElement && document.activeElement != this){if(document.activeElement.id == 'MailSubject' || document.activeElement.id == 'MailPreHeaderText') previousActiveElementId=document.activeElement.id; else previousActiveElementId=null;}" /><p>&nbsp;

                                <p>&nbsp;</p>

                                <label for="MailSubject">Betreff</label><br />
                                <input type="text" name="MailSubject" id="MailSubject" size="100" onchange="PageModified=true;" style="width: 99%;" />
                                <br /><br />
                                <label for="MailPreHeaderText">Pre-Header</label><SHOWHIDE:TOOLTIPS>
                                   <img onmouseover="showTooltip(event, 'Der Pre-Header/Vorschautext ist ein Text der von verschiedenen E-Mail-Programmen, z.B. Outlook, GoogleMail oder Thunderbird, in der E-Mail-Vorschau neuer E-Mails direkt unter oder neben dem E-Mail-Betreff angezeigt wird. Dieser Text kann, neben dem Betreff der E-Mail, verwendet werden, um den Empf&auml;nger des Newsletters zu motivieren Ihre E-Mail zu &ouml;ffnen.<br />Die L&auml;nge dieses Texts sollte zwischen 85 und 100 Zeichen liegen, l&auml;ngere Texte werden m&ouml;glicherweise abgeschnitten dargestellt.');return false" onmouseout="hideTooltip()" src="images/help_icon.gif" width="16" height="16" class="hintimage" alt="" />
                                   </SHOWHIDE:TOOLTIPS><br />
                                <input type="text" name="MailPreHeaderText" id="MailPreHeaderText" size="100" onchange="PageModified=true;" style="width: 99%;" />
                                <br />
                                <span name="AutoUpdateTextPartSpan" id="AutoUpdateTextPartSpan"><br />
                                  <input type="checkbox" id="AutoUpdateTextPart" name="AutoUpdateTextPart" value="1" /><label for="AutoUpdateTextPart">&nbsp;Text-Teil der E-Mail automatisch aus HTML-Teil erstellen</label>
                                </span>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                      </fieldset>

                      <!-- ##### InnerSpacer - START -->
                      <div class="spacerborder">
                      <!-- ##### InnerTabView - START -->
                      <div id="dhtmlgoodies_HTMLTexttabView">

                      <!-- ####### InnerTAB START -->
                      <script language="JavaScript" type="text/javascript">
                      <!--
                        InnerTabListArray.push('E-Mail im HTML-Format');
                      //-->
                      </script>
           	          <div class="dhtmlgoodies_aTab">
                        <br />
                          <table class="EditorTable" cellspacing="0" cellpadding="0" border="0" id="HTML">
                            <tbody>
                              <tr>
                                <td colspan="2" valign="top"><span id="MailHTMLTextWarnLabel" style="display: none;" class="missingvaluebackground">Der HTML-Teil der E-Mail muss einen Text enthalten oder Fehler m&uuml;ssen korrigiert werden.</span>
                                <textarea name="MailHTMLText" id="MailHTMLText" cols="100" rows="10" style="width: 99%; height: 440px"></textarea>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                      </div>
                      <!-- ####### Inner TAB END -->
                      <!-- ####### Inner TAB START -->
                      <script language="JavaScript" type="text/javascript">
                      <!--
                        InnerTabListArray.push('E-Mail im Text-Format');

                      //-->
                      </script>
                    	<div class="dhtmlgoodies_aTab">
                       <br />
                         <table class="EditorTable" cellspacing="0" cellpadding="0" border="0" id="PlainText">
                           <tbody>
                             <tr>
                               <td colspan="2" valign="middle">
                                 <select size="1" id="PlainTextPlaceHoldersCB" onchange="InsertFieldValue('PlainTextPlaceHoldersCB', 'MailPlainText')">
                                   <option selected="selected">Feld zum Einf&uuml;gen w&auml;hlen...</option>
                                 </select>&nbsp;<input type="image" src="images/btnCustomFct.gif" onclick="DoShowFunctionsDialog('AutoresponderEditForm', 'MailPlainText', false); return false;" alt="Funktionen" title="Funktionen" style="vertical-align:bottom" />&nbsp;
                                 &nbsp;<input type="image" src="images/btnTemplates.gif" onclick="TemplatesSelectDlgOpen('AutoresponderEditForm', 'MailPlainText', false); return false;" alt="E-Mail-Vorlagen" title="E-Mail-Vorlagen" style="vertical-align:bottom" /><p>&nbsp;
                                 </p>
                                 <textarea name="MailPlainText" id="MailPlainText" style="width: 99%; height: 440px" onchange="PageModified=true;"></textarea>
                               </td>
                             </tr>
                           </tbody>
                         </table>
                     </div>
                     <!-- ####### Inner TAB END -->

                      <!-- ####### Inner TAB START -->
                      <script language="JavaScript" type="text/javascript">
                      <!--
                        InnerTabListArray.push('Anh&auml;nge der E-Mail');

                      //-->
                      </script>
                    	<div class="dhtmlgoodies_aTab">
                       <br />
                         <table class="EditorTable" cellspacing="0" cellpadding="0" border="0">
                           <tbody>
                             <tr>
                               <td colspan="2" valign="middle">

                                 <div class="scrollbox" name="AttachmentsScrollbox" id="AttachmentsScrollbox">
                                   <Attachments>
                                     <span class="scrollboxSpan"><input type="checkbox" name="Attachments[]" value="<AttachmentsName></AttachmentsName>" id="AttachmentsId" />&nbsp;<label for="AttachmentsId"><AttachmentsName></AttachmentsName></label><br /></span>
                                   </Attachments>
                                 </div>
                                 <br />
                                 <input type="button" class="button" name="AttachmentsUploadBtn" value="Neue Datei(en) &uuml;bertragen" onclick="AttachmentUpload('AutoresponderEditForm', 'AttachmentsScrollbox', 'Attachments[]', null, ''); return false;" />&nbsp;&nbsp;
                                 <input type="button" class="button" name="AttachmentsDeleteBtn" value="Datei(en) l&ouml;schen" onclick="AttachmentDelete('AutoresponderEditForm', 'Attachments[]', 'Attachments[]'); return false;" />
                               </td>
                             </tr>
                           </tbody>
                         </table>
                     </div>
                     <!-- ####### Inner TAB END -->

                     </div>
                     <!-- ##### InnerTabView - END -->
                     <!-- ##### InnerSpacer - END -->
                     </div>

                   </div>
                  	<!-- ####### TAB END -->

                  </div>

                  <br />
                  <br />

                  <script type="text/javascript" src="ckeditor/ckeditor.js"></script>
                  <script type="text/javascript" src="templates/default/de/ckeditor_imageresize.js"></script>

                  <script language="JavaScript" type="text/javascript">
                  <!--
                    initTabs('dhtmlgoodies_tabView', TabListArray, 0, 924, 1030);
                    addScrollboxRolloverEffect('AttachmentsScrollbox','scrollboxRollOverEffect', null);

                    if(InnerTabListArray.length > 0)
                      initTabs('dhtmlgoodies_HTMLTexttabView', InnerTabListArray, 0, 894, 520);

                    function html_entity_decode( string ) {
                        var ret, tarea = document.createElement('textarea');
                        tarea.innerHTML = string;
                        ret = tarea.value;
                        return ret;
                    }

                    function FillComboBoxes() {
                        CBs = Array (
                            'SubjectPlaceHoldersCB',
                            'PlainTextPlaceHoldersCB'
                        )

          	            for(j=0; j<CBs.length; j++) {
                            CB = document.getElementById(CBs[j]);
                            if(CB == null) continue;
                            while (CB.length > 1)
                               CB.options[CB.length] = null;


                            for(i=0; i<arrPlaceholderItems.length; i++){
                              newOption = new Option(html_entity_decode(arrPlaceholderItems[i][1]), arrPlaceholderItems[i][0], false, false);
                              CB.options[CB.length] = newOption;
                            }

                            if ( (CBs[j] == 'SubjectPlaceHoldersCB') || (CBs[j] == 'PlainTextPlaceHoldersCB')
                               ) {
                               for(i=0; i<arrNewsletterUnsubscribePlaceholders.length; i++){
                                 newOption = new Option(html_entity_decode(arrNewsletterUnsubscribePlaceholders[i][1]), arrNewsletterUnsubscribePlaceholders[i][0], false, false);
                                 CB.options[CB.length] = newOption;
                               }
                               
                               for(i=0; i<arrResponderPlaceholders.length; i++){
                                 newOption = new Option(html_entity_decode(arrResponderPlaceholders[i][1]), arrResponderPlaceholders[i][0], false, false);
                                 CB.options[CB.length] = newOption;
                               }
                              }

                        }
                    }

                    FillComboBoxes();

                  -->
                  </script>

                  <script language="javascript" type="text/javascript">
                  <!--
                    ShowHideEMailTexts();
                    DisableItem('maillists_id', document.getElementById('UpdateMailingList').checked);
                    DisableItem('SerialMailPreviewDialog', document.getElementById('UpdateMailingList').checked);

                    function ShowNATextOnTab(TabId, Page, fieldId) {
                      var NA="Angabe nicht notwendig";

                      A = document.getElementById('tabView' + TabId + '_' + Page);
                      if(A == null) return;
                      tabSpanId = 'tabView' + TabId + '_' + Page + '_NAspan';
                      tabSpan = document.getElementById(tabSpanId);
                      if (document.getElementById(fieldId).style.display == 'none') {
                         if(tabSpan == null)
                            A.innerHTML = '<span id="' + tabSpanId + '">' + NA + '</span>' + A.innerHTML;
                            else
                            tabSpan.style.display = '';
                      } else {
                        if(tabSpan != null)
                           tabSpan.style.display = 'none';
                      }

                      // show correct tab
                      if( document.getElementById('MailFormat').selectedIndex > 0 )
                         showTab(TabId, 0);
                         else
                         showTab(TabId, 1);
                    }

                    var PageModified=false;

                    function ShowHideEMailTexts() {

                      if(document.getElementById('MailFormat') != null) {

                        if(document.getElementById('MailFormat').selectedIndex == 0){
                            HideCKEditor("MailHTMLText");
                          } else{
                              var iv = IsCKEditorVisible("MailHTMLText");
                              ShowCKEditor("MailHTMLText", "100%", 333, 'MyDefaultMailToolbar');
                              if(!iv) {
                                CKEDITOR.on('instanceReady', function( ev ) {
                            						CKEDITOR.instances['MailHTMLText'].on('key', function (e) {
                                    PageModified=true;
                                    e.removeListener();
                                  });

                                  CKEDITOR.instances['MailHTMLText'].on('blur', function(e) {
                                      if (e.editor.checkDirty()) {
                                         PageModified=true;
                                      }
                                  });

                                  AddImageSizeChangedEventToCKEditor('MailHTMLText');
                                  ev.removeListener();
                            				});
                              }
                          }

                        ShowItem('HTML', document.getElementById('MailFormat').selectedIndex > 0  );
                        ShowItem('PlainText', document.getElementById('MailFormat').selectedIndex != 1 );

                        if( document.getElementById('MailFormat').selectedIndex  == 2)
                           document.getElementById('AutoUpdateTextPartSpan').style.display = '';
                           else
                           document.getElementById('AutoUpdateTextPartSpan').style.display = 'none';
                      }


                      // HTML
                      ShowNATextOnTab('dhtmlgoodies_HTMLTexttabView', 0, 'HTML');

                      // TEXT
                      ShowNATextOnTab('dhtmlgoodies_HTMLTexttabView', 1, 'PlainText');

                      DisableItem('MailPreHeaderText', document.getElementById('MailFormat').selectedIndex != 0);


                    }

                    DisableControlsArray(!document.getElementById('NoTiming').checked, Array(document.getElementById('TimingFrom'), document.getElementById('TimingTo'), document.getElementById('TimingMultipleDayNamesScrollbox')), Array(document.getElementById('TimingLabel'), document.getElementById('TimingLabel1'), document.getElementById('TimingLabel2') ) );
                    DisableControlsArray(document.getElementById('UpdateMailingList').checked, Array(document.getElementById('maillists_id'), document.getElementById('NoAnswerOnMemberExists'), document.getElementById('formsList'), document.getElementById('SerialMailPreviewDialog')), Array(document.getElementById('NoAnswerOnMemberExistsLabel')));

                    DisableItem('AutoresponderLimitPerDay', document.getElementById('AutoresponderLimit').checked);

                    window.onbeforeunload = function (e) {
                        var e = e || window.event;
                        var warntext='Dokument wurde ge&auml;ndert ohne die &Auml;nderungen zu speichern.';

                        if (PageModified) {
                          // For IE and Firefox prior to version 4
                          if (e) {
                              e.returnValue = html_entity_decode(warntext);
                          }

                          // For Safari
                          return html_entity_decode(warntext);
                        }
                    }

                    InsertLoadingStatusOnSubmit();

                  	//AUTO_SCRIPT_CODE_PLACEHOLDER//

                  -->
                  </script>

                  <!-- ##### TabView - END -->

                </td>
              </tr>

              <tr>
                <td>
                <br />
                <input type="submit" name="AutoresponderEditBtn" value="&Auml;nderungen speichern" class="FormButton" onclick="PageModified=false;" />
                </td>
              </tr>

            </tbody>
          </table>
        </form>
      </div>

